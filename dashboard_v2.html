<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‰´ìŠ¤ ìœ íŠœë¸Œ ìë™í™” ëŒ€ì‹œë³´ë“œ v2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .api-config {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .api-config h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .api-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: bold;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .news-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .news-item {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .news-item:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .news-item.selected {
            border-color: #667eea;
            background: #e8ebff;
        }

        .news-item h3 {
            color: #333;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .news-item .meta {
            color: #666;
            font-size: 0.9em;
        }

        .status {
            padding: 15px;
            background: #f0f0f0;
            border-radius: 8px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
        }

        .status.loading {
            background: #d1ecf1;
            color: #0c5460;
        }

        .thumbnail-titles {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .thumbnail-title {
            padding: 10px;
            background: #f8f9ff;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .thumbnail-title:hover {
            border-color: #667eea;
            background: #e8ebff;
        }

        .thumbnail-title.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        .preview-section {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border: 2px solid #e0e0e0;
        }

        .preview-section h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .file-list {
            list-style: none;
            padding: 0;
        }

        .file-list li {
            padding: 10px;
            background: white;
            border-radius: 5px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-list .file-info {
            flex: 1;
        }

        .file-list .file-name {
            font-weight: bold;
            color: #333;
        }

        .file-list .file-size {
            color: #666;
            font-size: 0.9em;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: #667eea;
        }

        .close {
            font-size: 2em;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #333;
        }

        .final-review {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .final-review h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .review-item {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .review-item h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .review-item .content {
            color: #666;
            max-height: 150px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¬ ë‰´ìŠ¤ ìœ íŠœë¸Œ ìë™í™” ì‹œìŠ¤í…œ v2</h1>
            <p class="subtitle">ê°œì„ ëœ ë²„ì „ - ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° ë° API ì—°ë™</p>
        </header>

        <!-- API ì„¤ì • ì„¹ì…˜ -->
        <div class="api-config">
            <h2>âš™ï¸ API ì„¤ì •</h2>
            <div class="api-grid">
                <div class="input-group">
                    <label>AI ì„œë¹„ìŠ¤</label>
                    <select id="aiService">
                        <option value="gemini">Google Gemini (ì¶”ì²œ)</option>
                        <option value="openai">OpenAI GPT-4</option>
                        <option value="anthropic">Anthropic Claude</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>API í‚¤ (ì„ íƒì‚¬í•­ - Mock ëª¨ë“œ ê°€ëŠ¥)</label>
                    <input type="password" id="apiKey" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div>
                    <button class="btn btn-secondary" onclick="testAPI()">ğŸ§ª API ì—°ê²° í…ŒìŠ¤íŠ¸</button>
                </div>
            </div>
            <div id="apiTestResult" class="status" style="display:none; margin-top: 15px;"></div>
        </div>

        <div class="dashboard-grid">
            <!-- 1. ë‰´ìŠ¤ ìˆ˜ì§‘ ì¹´ë“œ -->
            <div class="card">
                <h2>ğŸ“° 1. ë‰´ìŠ¤ ìˆ˜ì§‘</h2>
                <div class="input-group">
                    <label>í‚¤ì›Œë“œ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                    <input type="text" id="keywords" value="ì‚¼ì„±,ì¿ íŒ¡,ë¶€ë™ì‚°,ì†í¥ë¯¼,AI" placeholder="ì‚¼ì„±, í˜„ëŒ€, ê²½ì œ...">
                </div>
                <div class="input-group">
                    <label>ìˆ˜ì§‘ ê°œìˆ˜</label>
                    <input type="number" id="newsCount" value="10" min="5" max="50">
                </div>
                <button class="btn" onclick="collectNews()">ğŸ” ë‰´ìŠ¤ ìˆ˜ì§‘ ì‹œì‘</button>
                <button class="btn btn-secondary" onclick="refreshNews()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                <div id="newsStatus" class="status" style="display:none;"></div>
                <div id="newsList" class="news-list"></div>
            </div>

            <!-- 2. AI ëŒ€ë³¸ ìƒì„± ì¹´ë“œ -->
            <div class="card">
                <h2>âœï¸ 2. AI ëŒ€ë³¸ ìƒì„±</h2>
                <button class="btn" onclick="generateScript()" id="generateScriptBtn" disabled>ğŸ“ ëŒ€ë³¸ ìƒì„±</button>
                <div id="scriptStatus" class="status" style="display:none;"></div>
                <div id="scriptPreview" class="preview-section" style="display:none;">
                    <h3>ğŸ“„ ìƒì„±ëœ ëŒ€ë³¸ ë¯¸ë¦¬ë³´ê¸°</h3>
                    <div id="scriptContent" style="max-height: 300px; overflow-y: auto; background: white; padding: 15px; border-radius: 5px;"></div>
                    <button class="btn btn-secondary" style="margin-top: 10px;" onclick="viewFullScript()">ğŸ“– ì „ì²´ ëŒ€ë³¸ ë³´ê¸°</button>
                </div>
            </div>

            <!-- 3. ì¸ë„¤ì¼ ì œëª© ìƒì„± ì¹´ë“œ -->
            <div class="card">
                <h2>ğŸ¨ 3. ì¸ë„¤ì¼ ì œëª©</h2>
                <button class="btn" onclick="generateThumbnails()" id="generateThumbnailBtn" disabled>ğŸ¯ ì¸ë„¤ì¼ ì œëª© 10ê°œ ìƒì„±</button>
                <div id="thumbnailStatus" class="status" style="display:none;"></div>
                <div id="thumbnailTitles" class="thumbnail-titles"></div>
            </div>

            <!-- 4. TTS ìŒì„± ìƒì„± ì¹´ë“œ -->
            <div class="card">
                <h2>ğŸ¤ 4. TTS ìŒì„± ìƒì„±</h2>
                <div class="input-group">
                    <label>TTS ì„œë¹„ìŠ¤</label>
                    <select id="ttsService">
                        <option value="mock">Mock (í…ŒìŠ¤íŠ¸)</option>
                        <option value="elevenlabs">ElevenLabs</option>
                        <option value="google">Google TTS</option>
                        <option value="azure">Azure TTS</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>ìŒì„± ìŠ¤íƒ€ì¼</label>
                    <select id="voiceStyle">
                        <option value="professional">ì „ë¬¸ì ì¸</option>
                        <option value="friendly">ì¹œê·¼í•œ</option>
                        <option value="energetic">í™œê¸°ì°¬</option>
                    </select>
                </div>
                <button class="btn" onclick="generateTTS()" id="generateTTSBtn" disabled>ğŸ”Š ìŒì„± ìƒì„±</button>
                <div id="ttsStatus" class="status" style="display:none;"></div>
                <div id="ttsPreview" class="preview-section" style="display:none;">
                    <h3>ğŸµ ìƒì„±ëœ ìŒì„± íŒŒì¼</h3>
                    <ul class="file-list" id="ttsFileList"></ul>
                </div>
            </div>

            <!-- 5. ì˜ìƒ í¸ì§‘ ì¹´ë“œ -->
            <div class="card">
                <h2>ğŸ¬ 5. ì˜ìƒ í¸ì§‘</h2>
                <div class="input-group">
                    <label>í¸ì§‘ ì†Œí”„íŠ¸ì›¨ì–´</label>
                    <select id="editSoftware">
                        <option value="mock">Mock (í…ŒìŠ¤íŠ¸)</option>
                        <option value="vrew">Vrew (ìë™ ìë§‰)</option>
                        <option value="premiere">Adobe Premiere</option>
                        <option value="davinci">DaVinci Resolve</option>
                    </select>
                </div>
                <button class="btn" onclick="editVideo()" id="editVideoBtn" disabled>âœ‚ï¸ ì˜ìƒ í¸ì§‘ ì‹œì‘</button>
                <div id="editStatus" class="status" style="display:none;"></div>
                <div id="videoPreview" class="preview-section" style="display:none;">
                    <h3>ğŸ¥ í¸ì§‘ëœ ì˜ìƒ íŒŒì¼</h3>
                    <ul class="file-list" id="videoFileList"></ul>
                </div>
            </div>

            <!-- 6. ìœ íŠœë¸Œ ì—…ë¡œë“œ ì¹´ë“œ -->
            <div class="card">
                <h2>ğŸ“¤ 6. ìœ íŠœë¸Œ ì—…ë¡œë“œ</h2>
                <div class="input-group">
                    <label>ì±„ë„ ì„ íƒ</label>
                    <select id="youtubeChannel">
                        <option value="channel1">ì‹œë‹ˆì–´ ë‰´ìŠ¤ ì±„ë„</option>
                        <option value="channel2">ê²½ì œ ë‰´ìŠ¤ ì±„ë„</option>
                        <option value="channel3">í…ŒìŠ¤íŠ¸ ì±„ë„</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>ì—…ë¡œë“œ ì‹œê°„</label>
                    <input type="datetime-local" id="uploadTime">
                </div>
                <button class="btn btn-secondary" onclick="showFinalReview()" id="reviewBtn" disabled>ğŸ‘€ ìµœì¢… í™•ì¸</button>
                <button class="btn" onclick="uploadVideo()" id="uploadBtn" disabled>ğŸš€ ìœ íŠœë¸Œ ì—…ë¡œë“œ</button>
                <div id="uploadStatus" class="status" style="display:none;"></div>
            </div>
        </div>
    </div>

    <!-- ëŒ€ë³¸ ì „ì²´ ë³´ê¸° ëª¨ë‹¬ -->
    <div id="scriptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“– ì „ì²´ ëŒ€ë³¸</h2>
                <span class="close" onclick="closeScriptModal()">&times;</span>
            </div>
            <div id="fullScriptContent" style="line-height: 1.8; white-space: pre-wrap;"></div>
        </div>
    </div>

    <!-- ìµœì¢… í™•ì¸ ëª¨ë‹¬ -->
    <div id="reviewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ‘€ ìµœì¢… í™•ì¸</h2>
                <span class="close" onclick="closeReviewModal()">&times;</span>
            </div>
            <div id="reviewContent"></div>
            <button class="btn" onclick="confirmUpload()" style="margin-top: 20px;">âœ… í™•ì¸ ì™„ë£Œ - ì—…ë¡œë“œ ì¤€ë¹„</button>
        </div>
    </div>

    <script>
        let collectedNews = [];
        let selectedNews = null;
        let generatedScript = null;
        let selectedThumbnail = null;
        let generatedAudio = null;
        let editedVideo = null;
        let thumbnailTitles = [];

        // API ì—°ê²° í…ŒìŠ¤íŠ¸
        async function testAPI() {
            const apiKey = document.getElementById('apiKey').value;
            const service = document.getElementById('aiService').value;
            const resultDiv = document.getElementById('apiTestResult');

            resultDiv.style.display = 'block';
            resultDiv.className = 'status loading';
            resultDiv.textContent = 'API ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...';

            if (!apiKey) {
                resultDiv.className = 'status error';
                resultDiv.textContent = 'âŒ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nMock ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ API í‚¤ ì—†ì´ ì§„í–‰í•˜ì„¸ìš”.';
                return;
            }

            // Gemini API í…ŒìŠ¤íŠ¸
            if (service === 'gemini') {
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{ text: "ì•ˆë…•í•˜ì„¸ìš”. ê°„ë‹¨íˆ ì¸ì‚¬ë§ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”." }]
                            }]
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        const text = data.candidates[0].content.parts[0].text;

                        resultDiv.className = 'status success';
                        resultDiv.textContent = `âœ… Gemini API ì—°ê²° ì„±ê³µ!\n\ní…ŒìŠ¤íŠ¸ ì‘ë‹µ: ${text}\n\nì´ API í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
                    } else {
                        const errorData = await response.json();
                        resultDiv.className = 'status error';
                        resultDiv.textContent = `âŒ API ì—°ê²° ì‹¤íŒ¨\n\nìƒíƒœ: ${response.status}\nì˜¤ë¥˜: ${JSON.stringify(errorData, null, 2)}\n\ní•´ê²°ë°©ë²•:\n1. https://makersuite.google.com/app/apikey ì—ì„œ í‚¤ í™•ì¸\n2. Gemini APIê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸`;
                    }
                } catch (error) {
                    resultDiv.className = 'status error';
                    resultDiv.textContent = `âŒ ì—°ê²° ì˜¤ë¥˜: ${error.message}`;
                }
            }
        }

        // 1. ë‰´ìŠ¤ ìˆ˜ì§‘
        async function collectNews() {
            const keywords = document.getElementById('keywords').value;
            const count = document.getElementById('newsCount').value;
            const statusDiv = document.getElementById('newsStatus');
            const newsListDiv = document.getElementById('newsList');

            statusDiv.style.display = 'block';
            statusDiv.className = 'status loading';
            statusDiv.textContent = 'ë‰´ìŠ¤ ìˆ˜ì§‘ ì¤‘...';

            // ì‹¤ì œ ë‰´ìŠ¤ ìˆ˜ì§‘ ì‹œë®¬ë ˆì´ì…˜
            setTimeout(() => {
                const keywordList = keywords.split(',').map(k => k.trim());
                collectedNews = [];

                // ë‹¤ì–‘í•œ ë‰´ìŠ¤ ìƒì„±
                const newsTemplates = [
                    { title: 'ì‚¼ì„±ì „ì, ë°˜ë„ì²´ ë¶„ì•¼ 50ì¡° íˆ¬ì ë°œí‘œ', keyword: 'ì‚¼ì„±', score: 2.5 },
                    { title: 'ì¿ íŒ¡ ìƒˆë²½ë°°ì†¡, ì „êµ­ 95% ì§€ì—­ìœ¼ë¡œ í™•ëŒ€', keyword: 'ì¿ íŒ¡', score: 2.3 },
                    { title: 'ì„œìš¸ ì•„íŒŒíŠ¸ í‰ê·  ë§¤ë§¤ê°€ 12ì–µ ëŒíŒŒ', keyword: 'ë¶€ë™ì‚°', score: 2.1 },
                    { title: 'ì†í¥ë¯¼, EPL í†µì‚° 100í˜¸ê³¨ ë‹¬ì„±', keyword: 'ì†í¥ë¯¼', score: 1.9 },
                    { title: 'AI ë°˜ë„ì²´ ì‹œì¥, ì˜¬í•´ 2ë°° ì„±ì¥ ì „ë§', keyword: 'AI', score: 1.8 },
                    { title: 'í˜„ëŒ€ì°¨, ì „ê¸°ì°¨ ì‹ ëª¨ë¸ 3ì¢… ì¶œì‹œ', keyword: 'í˜„ëŒ€', score: 1.7 },
                    { title: 'LGì—ë„ˆì§€ì†”ë£¨ì…˜, ë¶ë¯¸ ê³µì¥ ì¦ì„¤', keyword: 'LG', score: 1.6 },
                    { title: 'ë„¤ì´ë²„, AI ê²€ìƒ‰ ì„œë¹„ìŠ¤ ëŒ€í­ ê°œì„ ', keyword: 'ë„¤ì´ë²„', score: 1.5 }
                ];

                keywordList.forEach((keyword, idx) => {
                    const template = newsTemplates[idx % newsTemplates.length];
                    collectedNews.push({
                        id: Date.now() + idx,
                        title: template.title.replace(/ì‚¼ì„±|ì¿ íŒ¡|ë¶€ë™ì‚°|ì†í¥ë¯¼|AI/, keyword),
                        description: `${keyword}ì— ëŒ€í•œ ìµœì‹  ë‰´ìŠ¤ì…ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ê¸°ì‚¬ì—ì„œ í™•ì¸í•˜ì„¸ìš”.`,
                        keyword: keyword,
                        relevance_score: template.score,
                        pub_date: new Date().toISOString(),
                        collected_at: new Date().toLocaleString()
                    });
                });

                statusDiv.className = 'status success';
                statusDiv.textContent = `âœ… ${collectedNews.length}ê°œ ë‰´ìŠ¤ ìˆ˜ì§‘ ì™„ë£Œ!\nìˆ˜ì§‘ ì‹œê°„: ${new Date().toLocaleString()}`;

                renderNewsList();
            }, 2000);
        }

        // ë‰´ìŠ¤ ìƒˆë¡œê³ ì¹¨
        function refreshNews() {
            collectNews();
        }

        function renderNewsList() {
            const newsListDiv = document.getElementById('newsList');
            newsListDiv.innerHTML = '<h3 style="margin: 15px 0;">ìˆ˜ì§‘ëœ ë‰´ìŠ¤ (í´ë¦­í•˜ì—¬ ì„ íƒ)</h3>';

            collectedNews.forEach(news => {
                const newsItem = document.createElement('div');
                newsItem.className = 'news-item';
                newsItem.onclick = () => selectNews(news);
                newsItem.innerHTML = `
                    <h3>${news.title}</h3>
                    <div class="meta">
                        í‚¤ì›Œë“œ: ${news.keyword} | ê´€ë ¨ì„±: ${news.relevance_score.toFixed(1)} | ìˆ˜ì§‘: ${news.collected_at}
                    </div>
                `;
                newsListDiv.appendChild(newsItem);
            });
        }

        function selectNews(news) {
            selectedNews = news;
            document.querySelectorAll('.news-item').forEach(item => {
                item.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            document.getElementById('generateScriptBtn').disabled = false;

            // ì„ íƒ ì•Œë¦¼
            const statusDiv = document.getElementById('newsStatus');
            statusDiv.className = 'status success';
            statusDiv.textContent = `âœ… ì„ íƒë¨: ${news.title}`;
        }

        // 2. AI ëŒ€ë³¸ ìƒì„±
        async function generateScript() {
            if (!selectedNews) {
                alert('ë¨¼ì € ë‰´ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }

            const apiKey = document.getElementById('apiKey').value;
            const service = document.getElementById('aiService').value;
            const statusDiv = document.getElementById('scriptStatus');
            const previewDiv = document.getElementById('scriptPreview');
            const contentDiv = document.getElementById('scriptContent');

            statusDiv.style.display = 'block';
            statusDiv.className = 'status loading';
            statusDiv.textContent = 'AI ëŒ€ë³¸ ìƒì„± ì¤‘... (ì•½ 30ì´ˆ ì†Œìš”)';
            previewDiv.style.display = 'none';

            // ì‹¤ì œ API í˜¸ì¶œ
            if (apiKey && service === 'gemini') {
                try {
                    const prompt = `ë‹¹ì‹ ì€ ì‹œë‹ˆì–´ì¸µ(40~60ëŒ€)ì„ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” ìœ íŠœë¸Œ ë‰´ìŠ¤ ì±„ë„ì˜ ì „ë¬¸ ì‘ê°€ì…ë‹ˆë‹¤.

ì•„ë˜ ë‰´ìŠ¤ ê¸°ì‚¬ë¥¼ ë°”íƒ•ìœ¼ë¡œ 8~10ë¶„ ë¶„ëŸ‰ì˜ ìœ íŠœë¸Œ ì˜ìƒ ëŒ€ë³¸ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.

[ë‰´ìŠ¤ ê¸°ì‚¬]
ì œëª©: ${selectedNews.title}
ë‚´ìš©: ${selectedNews.description}

[ëŒ€ë³¸ ì‘ì„± ìš”êµ¬ì‚¬í•­]
1. **ë„ì…ë¶€ (30ì´ˆ)**: ê°•ë ¥í•œ í›„í‚¹ ë©˜íŠ¸ë¡œ ì‹œì‘ (ì˜ˆ: "ì—¬ëŸ¬ë¶„, ì´ê±° ì•„ì‹­ë‹ˆê¹Œ?", "ì¶©ê²©ì ì¸ ì†Œì‹ì…ë‹ˆë‹¤")
2. **ë³¸ë¬¸ (7ë¶„)**:
   - ê¸°ì‚¬ ë‚´ìš©ì„ ì‰½ê³  ìì„¸í•˜ê²Œ ì„¤ëª…
   - ì „ë¬¸ ìš©ì–´ëŠ” í’€ì–´ì„œ ì„¤ëª…
   - ì¤‘ê°„ì¤‘ê°„ ì‹œì²­ì ëª°ì… ìœ ë„ ë©˜íŠ¸ ì‚½ì…
3. **ë§ˆë¬´ë¦¬ (30ì´ˆ)**:
   - í•µì‹¬ ìš”ì•½
   - êµ¬ë…, ì¢‹ì•„ìš”, ì•Œë¦¼ ì„¤ì • ìš”ì²­
   - ë‹¤ìŒ ì˜ìƒ ì˜ˆê³ 

[í†¤ ë° ìŠ¤íƒ€ì¼]
- ì „ë‹¬í˜•, ì¡´ì¤‘í•˜ëŠ” ì–´ì¡°
- "ì—¬ëŸ¬ë¶„", "~ì…ë‹ˆë‹¤" ë“± ì •ì¤‘í•œ í‘œí˜„
- ê°ì •ì  ì–´í•„ë³´ë‹¤ëŠ” ì‚¬ì‹¤ ì¤‘ì‹¬

ëŒ€ë³¸ë§Œ ì¶œë ¥í•´ì£¼ì„¸ìš”.`;

                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: prompt }] }]
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        generatedScript = data.candidates[0].content.parts[0].text;

                        statusDiv.className = 'status success';
                        statusDiv.textContent = `âœ… ëŒ€ë³¸ ìƒì„± ì™„ë£Œ!\nê¸¸ì´: ${generatedScript.length}ì (ì•½ ${Math.floor(generatedScript.length / 150)} ë¶„ ë¶„ëŸ‰)`;

                        contentDiv.textContent = generatedScript.substring(0, 500) + '...';
                        previewDiv.style.display = 'block';

                        document.getElementById('generateThumbnailBtn').disabled = false;
                    } else {
                        throw new Error(`API ì˜¤ë¥˜: ${response.status}`);
                    }
                } catch (error) {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = `âŒ ëŒ€ë³¸ ìƒì„± ì‹¤íŒ¨: ${error.message}\n\nMock ëª¨ë“œë¡œ ì „í™˜í•©ë‹ˆë‹¤...`;

                    // Mock ëª¨ë“œë¡œ ëŒ€ì²´
                    setTimeout(() => generateScriptMock(), 1000);
                }
            } else {
                // Mock ëª¨ë“œ
                generateScriptMock();
            }
        }

        function generateScriptMock() {
            const statusDiv = document.getElementById('scriptStatus');
            const previewDiv = document.getElementById('scriptPreview');
            const contentDiv = document.getElementById('scriptContent');

            setTimeout(() => {
                generatedScript = `ì—¬ëŸ¬ë¶„, ì•ˆë…•í•˜ì„¸ìš”. ì˜¤ëŠ˜ì€ ì •ë§ ì¤‘ìš”í•œ ì†Œì‹ì„ ê°€ì§€ê³  ì™”ìŠµë‹ˆë‹¤.

[ë„ì…ë¶€]
${selectedNews.title}ì— ëŒ€í•´ í˜¹ì‹œ ë“¤ì–´ë³´ì…¨ë‚˜ìš”? ìµœê·¼ ë§ì€ ë¶„ë“¤ì´ ê´€ì‹¬ì„ ê°€ì§€ê³  ê³„ì‹  ì´ ë‚´ìš©, ì˜¤ëŠ˜ ìì„¸íˆ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

[ë³¸ë¬¸]
ë¨¼ì € ì‚¬ê±´ì˜ ì „ë§ì„ ë§ì”€ë“œë¦¬ìë©´, ${selectedNews.description}

ì´ëŠ” ìš°ë¦¬ ìƒí™œì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹ ê¹Œìš”? ì „ë¬¸ê°€ë“¤ì€ ë‹¤ì–‘í•œ ì˜ê²¬ì„ ë‚´ë†“ê³  ìˆëŠ”ë°ìš”...

(ë³¸ë¬¸ ê³„ì† - ì‹¤ì œë¡œëŠ” 8-10ë¶„ ë¶„ëŸ‰)

[ë§ˆë¬´ë¦¬]
ì˜¤ëŠ˜ ì˜ìƒì´ ë„ì›€ì´ ë˜ì…¨ë‹¤ë©´ êµ¬ë…ê³¼ ì¢‹ì•„ìš”, ì•Œë¦¼ ì„¤ì • ë¶€íƒë“œë¦½ë‹ˆë‹¤.
ë‹¤ìŒ ì˜ìƒì—ì„œëŠ” ë” ìœ ìµí•œ ì •ë³´ë¡œ ì°¾ì•„ëµ™ê² ìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.`;

                statusDiv.className = 'status success';
                statusDiv.textContent = `âœ… ëŒ€ë³¸ ìƒì„± ì™„ë£Œ! (Mock ëª¨ë“œ)\nê¸¸ì´: ${generatedScript.length}ì (ì•½ ${Math.floor(generatedScript.length / 150)} ë¶„ ë¶„ëŸ‰)`;

                contentDiv.textContent = generatedScript.substring(0, 500) + '...';
                previewDiv.style.display = 'block';

                document.getElementById('generateThumbnailBtn').disabled = false;
            }, 3000);
        }

        function viewFullScript() {
            document.getElementById('fullScriptContent').textContent = generatedScript;
            document.getElementById('scriptModal').style.display = 'block';
        }

        function closeScriptModal() {
            document.getElementById('scriptModal').style.display = 'none';
        }

        // 3. ì¸ë„¤ì¼ ì œëª© ìƒì„±
        async function generateThumbnails() {
            if (!selectedNews || !generatedScript) {
                alert('ë¨¼ì € ëŒ€ë³¸ì„ ìƒì„±í•´ì£¼ì„¸ìš”!');
                return;
            }

            const apiKey = document.getElementById('apiKey').value;
            const service = document.getElementById('aiService').value;
            const statusDiv = document.getElementById('thumbnailStatus');
            const titlesDiv = document.getElementById('thumbnailTitles');

            statusDiv.style.display = 'block';
            statusDiv.className = 'status loading';
            statusDiv.textContent = 'ì¸ë„¤ì¼ ì œëª© ìƒì„± ì¤‘...';
            titlesDiv.innerHTML = '';

            // ì‹¤ì œ API í˜¸ì¶œ
            if (apiKey && service === 'gemini') {
                try {
                    const prompt = `ì•„ë˜ ë‰´ìŠ¤ ì œëª©ê³¼ ëŒ€ë³¸ì„ ë°”íƒ•ìœ¼ë¡œ ìœ íŠœë¸Œ ì¸ë„¤ì¼ì— ë“¤ì–´ê°ˆ ê°•ë ¥í•œ í›„í‚¹ ë¬¸êµ¬ë¥¼ 10ê°œ ìƒì„±í•´ì£¼ì„¸ìš”.

ë‰´ìŠ¤ ì œëª©: ${selectedNews.title}
ëŒ€ë³¸ ë‚´ìš©: ${generatedScript.substring(0, 300)}...

[ìš”êµ¬ì‚¬í•­]
1. 15ì ì´ë‚´ë¡œ ê°„ê²°í•˜ê²Œ
2. ì¶©ê²©, ê¶ê¸ˆì¦ ìœ ë°œ
3. ëŒ€ë³¸ ë‚´ìš©ê³¼ ì—°ê´€ì„± ìˆê²Œ
4. ë‹¤ì–‘í•œ ìŠ¤íƒ€ì¼ ì‚¬ìš©:
   - ì§ˆë¬¸í˜•: "ì´ê²Œ ê°€ëŠ¥í•´?"
   - ìˆ«ìí˜•: "50ì¡° íˆ¬ì"
   - ì¶©ê²©í˜•: "ê²½ì•…! ~~"
   - ë°˜ì „í˜•: "ì•Œê³ ë³´ë‹ˆ..."

ê° ì œëª©ë§Œ ë²ˆí˜¸ì™€ í•¨ê»˜ ì¶œë ¥í•´ì£¼ì„¸ìš”. ë‹¤ë¥¸ ì„¤ëª…ì€ í•˜ì§€ ë§ˆì„¸ìš”.`;

                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: prompt }] }]
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        const text = data.candidates[0].content.parts[0].text;

                        thumbnailTitles = text.split('\n')
                            .filter(line => line.trim())
                            .map(line => line.replace(/^\d+\.\s*/, '').trim());

                        renderThumbnailTitles(thumbnailTitles);

                        statusDiv.className = 'status success';
                        statusDiv.textContent = `âœ… ${thumbnailTitles.length}ê°œ ì¸ë„¤ì¼ ì œëª© ìƒì„± ì™„ë£Œ!`;

                        document.getElementById('generateTTSBtn').disabled = false;
                    } else {
                        throw new Error(`API ì˜¤ë¥˜: ${response.status}`);
                    }
                } catch (error) {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = `âŒ ì œëª© ìƒì„± ì‹¤íŒ¨: ${error.message}\n\nMock ëª¨ë“œë¡œ ì „í™˜í•©ë‹ˆë‹¤...`;

                    setTimeout(() => generateThumbnailsMock(), 1000);
                }
            } else {
                generateThumbnailsMock();
            }
        }

        function generateThumbnailsMock() {
            const statusDiv = document.getElementById('thumbnailStatus');

            setTimeout(() => {
                thumbnailTitles = [
                    `${selectedNews.keyword} ì‹¤í™”?`,
                    'ì¶©ê²©! 50ì¡° íˆ¬ì',
                    'ê²°êµ­ í„°ì¡ŒìŠµë‹ˆë‹¤',
                    'ì•Œê³  ë³´ë‹ˆ ëŒ€ë°•',
                    'ì§€ê¸ˆ ë‹¹ì¥ í™•ì¸',
                    '99% ëª¨ë¥´ëŠ” ì‚¬ì‹¤',
                    'ë’¤ëŠ¦ì€ í›„íšŒ',
                    'ì „ë¬¸ê°€ë„ ë†€ë€',
                    'ì´ì œì•¼ ë°í˜€ì§„',
                    'ë°˜ë“œì‹œ ì•Œì•„ì•¼ í• '
                ];

                renderThumbnailTitles(thumbnailTitles);

                statusDiv.className = 'status success';
                statusDiv.textContent = `âœ… 10ê°œ ì¸ë„¤ì¼ ì œëª© ìƒì„± ì™„ë£Œ! (Mock ëª¨ë“œ)`;

                document.getElementById('generateTTSBtn').disabled = false;
            }, 2000);
        }

        function renderThumbnailTitles(titles) {
            const titlesDiv = document.getElementById('thumbnailTitles');
            titlesDiv.innerHTML = '';

            titles.slice(0, 10).forEach((title, index) => {
                const titleDiv = document.createElement('div');
                titleDiv.className = 'thumbnail-title';
                titleDiv.textContent = title;
                titleDiv.onclick = () => selectThumbnail(title, titleDiv);
                titlesDiv.appendChild(titleDiv);
            });
        }

        function selectThumbnail(title, element) {
            selectedThumbnail = title;
            document.querySelectorAll('.thumbnail-title').forEach(item => {
                item.classList.remove('selected');
            });
            element.classList.add('selected');

            const statusDiv = document.getElementById('thumbnailStatus');
            statusDiv.className = 'status success';
            statusDiv.textContent = `âœ… ì„ íƒë¨: ${title}`;
        }

        // 4. TTS ìŒì„± ìƒì„±
        async function generateTTS() {
            if (!generatedScript) {
                alert('ë¨¼ì € ëŒ€ë³¸ì„ ìƒì„±í•´ì£¼ì„¸ìš”!');
                return;
            }

            const statusDiv = document.getElementById('ttsStatus');
            const previewDiv = document.getElementById('ttsPreview');
            const fileListDiv = document.getElementById('ttsFileList');

            statusDiv.style.display = 'block';
            statusDiv.className = 'status loading';
            statusDiv.textContent = 'AI ìŒì„± ìƒì„± ì¤‘... (ì•½ 1ë¶„ ì†Œìš”)';
            previewDiv.style.display = 'none';

            setTimeout(() => {
                generatedAudio = {
                    filename: `voice_${Date.now()}.mp3`,
                    duration: Math.floor(generatedScript.length / 150),
                    size: '15.2 MB',
                    path: 'output/audio/voice_xxxxx.mp3'
                };

                statusDiv.className = 'status success';
                statusDiv.innerHTML = `âœ… ìŒì„± íŒŒì¼ ìƒì„± ì™„ë£Œ!
íŒŒì¼ëª…: ${generatedAudio.filename}
ê¸¸ì´: ${generatedAudio.duration}ë¶„ ${Math.floor(Math.random() * 60)}ì´ˆ
í¬ê¸°: ${generatedAudio.size}`;

                fileListDiv.innerHTML = `
                    <li>
                        <div class="file-info">
                            <div class="file-name">ğŸµ ${generatedAudio.filename}</div>
                            <div class="file-size">ê¸¸ì´: ${generatedAudio.duration}ë¶„ | í¬ê¸°: ${generatedAudio.size}</div>
                        </div>
                    </li>
                `;
                previewDiv.style.display = 'block';

                document.getElementById('editVideoBtn').disabled = false;
            }, 3000);
        }

        // 5. ì˜ìƒ í¸ì§‘
        async function editVideo() {
            if (!generatedAudio) {
                alert('ë¨¼ì € ìŒì„±ì„ ìƒì„±í•´ì£¼ì„¸ìš”!');
                return;
            }

            const statusDiv = document.getElementById('editStatus');
            const previewDiv = document.getElementById('videoPreview');
            const fileListDiv = document.getElementById('videoFileList');

            statusDiv.style.display = 'block';
            statusDiv.className = 'status loading';
            statusDiv.textContent = 'ì˜ìƒ í¸ì§‘ ì¤‘... (ìë§‰ ìë™ ìƒì„±, ì´ë¯¸ì§€ ì‚½ì…)';
            previewDiv.style.display = 'none';

            setTimeout(() => {
                editedVideo = {
                    filename: `video_${Date.now()}.mp4`,
                    resolution: '1920x1080',
                    duration: generatedAudio.duration,
                    size: '245 MB',
                    path: 'output/videos/video_xxxxx.mp4'
                };

                statusDiv.className = 'status success';
                statusDiv.innerHTML = `âœ… ì˜ìƒ í¸ì§‘ ì™„ë£Œ!
íŒŒì¼ëª…: ${editedVideo.filename}
í•´ìƒë„: ${editedVideo.resolution}
ê¸¸ì´: ${editedVideo.duration}ë¶„
í¬ê¸°: ${editedVideo.size}`;

                fileListDiv.innerHTML = `
                    <li>
                        <div class="file-info">
                            <div class="file-name">ğŸ¥ ${editedVideo.filename}</div>
                            <div class="file-size">${editedVideo.resolution} | ${editedVideo.duration}ë¶„ | ${editedVideo.size}</div>
                        </div>
                    </li>
                `;
                previewDiv.style.display = 'block';

                document.getElementById('reviewBtn').disabled = false;
                document.getElementById('uploadBtn').disabled = false;
            }, 5000);
        }

        // ìµœì¢… í™•ì¸
        function showFinalReview() {
            const reviewContent = document.getElementById('reviewContent');

            reviewContent.innerHTML = `
                <div class="review-item">
                    <h3>ğŸ“° ì„ íƒëœ ë‰´ìŠ¤</h3>
                    <div class="content">${selectedNews.title}</div>
                </div>
                <div class="review-item">
                    <h3>ğŸ“ ëŒ€ë³¸</h3>
                    <div class="content">${generatedScript.substring(0, 200)}... (ì „ì²´ ${generatedScript.length}ì)</div>
                </div>
                <div class="review-item">
                    <h3>ğŸ¨ ì¸ë„¤ì¼ ì œëª©</h3>
                    <div class="content">${selectedThumbnail || 'ì„ íƒ ì•ˆë¨'}</div>
                </div>
                <div class="review-item">
                    <h3>ğŸµ ìŒì„± íŒŒì¼</h3>
                    <div class="content">${generatedAudio.filename} (${generatedAudio.duration}ë¶„)</div>
                </div>
                <div class="review-item">
                    <h3>ğŸ¥ ì˜ìƒ íŒŒì¼</h3>
                    <div class="content">${editedVideo.filename} (${editedVideo.resolution}, ${editedVideo.size})</div>
                </div>
                <div class="review-item">
                    <h3>ğŸ“¤ ì—…ë¡œë“œ ì„¤ì •</h3>
                    <div class="content">
                        ì±„ë„: ${document.getElementById('youtubeChannel').options[document.getElementById('youtubeChannel').selectedIndex].text}<br>
                        ì—…ë¡œë“œ ì‹œê°„: ${document.getElementById('uploadTime').value || 'ì¦‰ì‹œ'}
                    </div>
                </div>
            `;

            document.getElementById('reviewModal').style.display = 'block';
        }

        function closeReviewModal() {
            document.getElementById('reviewModal').style.display = 'none';
        }

        function confirmUpload() {
            closeReviewModal();
            alert('âœ… ìµœì¢… í™•ì¸ ì™„ë£Œ! ì´ì œ ì—…ë¡œë“œ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.');
        }

        // 6. ìœ íŠœë¸Œ ì—…ë¡œë“œ
        async function uploadVideo() {
            if (!editedVideo) {
                alert('ë¨¼ì € ì˜ìƒì„ í¸ì§‘í•´ì£¼ì„¸ìš”!');
                return;
            }

            const statusDiv = document.getElementById('uploadStatus');
            statusDiv.style.display = 'block';
            statusDiv.className = 'status loading';
            statusDiv.textContent = 'ìœ íŠœë¸Œ ì—…ë¡œë“œ ì¤‘...';

            setTimeout(() => {
                const videoUrl = `https://www.youtube.com/watch?v=MOCK_${Date.now()}`;

                statusDiv.className = 'status success';
                statusDiv.innerHTML = `âœ… ìœ íŠœë¸Œ ì—…ë¡œë“œ ì™„ë£Œ!
ì˜ìƒ ì œëª©: ${selectedNews.title}
ì¸ë„¤ì¼: ${selectedThumbnail || 'ìë™'}
ì—…ë¡œë“œ ì‹œê°„: ${document.getElementById('uploadTime').value || 'ì¦‰ì‹œ'}
URL: <a href="${videoUrl}" target="_blank" style="color: #667eea; font-weight: bold;">${videoUrl}</a>`;

                alert('ğŸ‰ ì „ì²´ ì›Œí¬í”Œë¡œìš° ì™„ë£Œ! ì˜ìƒì´ ìœ íŠœë¸Œì— ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }, 3000);
        }

        // ì´ˆê¸°í™”
        window.onload = function() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            tomorrow.setHours(18, 0, 0, 0);
            document.getElementById('uploadTime').value = tomorrow.toISOString().slice(0, 16);

            // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
            window.onclick = function(event) {
                if (event.target.className === 'modal') {
                    event.target.style.display = 'none';
                }
            }
        };
    </script>
</body>
</html>
